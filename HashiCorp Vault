SECTION 1 — ARCHITECTURE DIAGRAMS
1.1 Primary Architecture Diagram


                   +------------------------------------------+
                   |            Calix Kubernetes Cluster       |
                   |                  (RKE2)                   |
                   |                                          |
                   |   +-----------------------------+        |
                   |   | External Secrets Operator   |        |
                   |   |  - ESO Controller           |        |
                   |   |  - Vault Provider Plugin    |        |
                   |   +--------------+--------------+        |
                   |                  |                       |
                   |                  | HTTPS:8200            |
                   +------------------|------------------------+
                                      |
                                      |
                        +-------------v----------------+
                        |   plnx-vault.calix.local     |
                        |        Vault Server          |
                        |   ------------------------   |
                        |   - TLS Enabled (POC)        |
                        |   - KV v2 Secret Engine      |
                        |   - Scoped Policy (es-read)  |
                        |   - Token for ESO            |
                        |   - File Storage Backend     |
                        +------------------------------+


1.2 Workflow Diagram (End-to-End Secret Flow)

                  +-----------------------------+
                  |    HashiCorp Vault (POC)    |
                  |      KV v2 Secret Engine    |
                  +--------------+--------------+
                                 |
                                 | 1. vault kv get/put
                                 |
                                 v
                      +----------------------+
                      |  Vault Policy (es-read) 
                      |  Token issued for ESO  
                      +----------+-----------+
                                 |
                                 | 2. ESO reads token 
                                 |    from K8s Secret
                                 |
                                 v
     +--------------------------------------------------------+
     |             External Secrets Operator (ESO)            |
     |   - Watches ExternalSecret CRDs                        |
     |   - Uses ClusterSecretStore to connect to Vault        |
     |   - Fetches secrets from Vault over HTTPS (8200)       |
     |   - Writes Kubernetes Secrets                          |
     +--------------------------+-----------------------------+
                                |
                                | 3. Writes synced secret
                                |    into Kubernetes
                                |
                                v
                 +--------------------------------+
                 |   Kubernetes Secret (owned by   |
                 |       External Secrets)         |
                 |  Name: my-synced-secret         |
                 |                                  |
                 |  - username                      |
                 |  - password                      |
                 +----------------+-----------------+
                                  |
                                  | 4. Used by application pods
                                  |
                                  v
                        +------------------------+
                        |   Application Pods     |
                        +------------------------+


1.3 Connectivity Diagram (TLS & Network Requirements)

Kubernetes Nodes  ---------------------------------->  Vault Server
   (All RKE2 Worker/Control Nodes)                   plnx-vault.calix.local
                                                     IP: 10.172.249.106

Protocol: HTTPS (TLS)
Port:     8200/tcp
CA Trust: Custom CA via caBundle
Auth:     Vault Token (policy: es-read)


1.4 Reconciliation Behavior Diagram
               ExternalSecret (vault-example)
                          |
                          | creates/updates
                          v
            +-----------------------------------+
            |   my-synced-secret (K8s Secret)   |
            +-----------------------------------+
                          ^
                          |
                          | Auto-Recreate if Deleted
                          |
                  ESO Reconciliation Loop
                (Every refreshInterval: 15 seconds)



SECTION 2 — POC SCOPE AND OBJECTIVES
2.1 POC Scope

This POC demonstrates the full lifecycle and integration of an on-prem HashiCorp Vault server with the Calix Kubernetes platform using External Secrets Operator (ESO). The POC validates that secrets stored in Vault can be securely synced into the Kubernetes cluster as native K8s secrets without exposing credentials.

In-Scope

Deployment of Vault on RHEL 9

TLS enablement using a self-signed certificate (temporary)

KV v2 secret engine configuration

Vault policy & token creation for ESO

ESO installation in Kubernetes (RKE2)

ClusterSecretStore creation

ExternalSecret synchronization

Verification of secret reconciliation behavior

Out-of-Scope

Vault clustering / HA

Vault auto-unseal using HSM/KMS

Production PKI onboarding

Application-level RBAC design

Multi-environment Vault structure

2.2 POC Objectives
Functional Objectives

Deploy Vault with TLS enabled

Enable KV v2 secrets engine

Store and retrieve secrets

Create scoped Vault policy

Issue token for ESO authentication

Install ESO and CRDs

Validate secure traffic between cluster and Vault

Synchronize Vault secrets into Kubernetes

Success Criteria

Vault reachable over HTTPS 8200

KV v2 engine working

Vault policy enforced correctly

ESO components running

ClusterSecretStore status = Valid + Ready

Kubernetes secret created from Vault

Auto-recreation of secret upon deletion

SECTION 3 — HOST DETAILS AND RESOURCE ALLOCATION
3.1 Vault Host Information
Attribute	Value
Hostname	plnx-vault.calix.local
IP Address	10.172.249.106
OS	RHEL 9.x (Minimal Install)
SELinux	Enforcing
Firewall	firewalld
Vault Edition	Open Source (binary install)
Storage Backend	File storage: /opt/vault/data
TLS Directory	/opt/vault/tls/
Config Directory	/etc/vault.d/
Binary	/usr/local/bin/vault
3.2 Resource Allocation (POC)
Resource	Allocation
vCPU	2
Memory	4 GB
Disk	50 GB
Network	1 Gbps


SECTION 3 — HOST DETAILS AND RESOURCE ALLOCATION


| Attribute            | Value                           |
| -------------------- | ------------------------------- |
| **Hostname**         | `plnx-vault.calix.local`        |
| **IP Address**       | `10.172.249.106`                |
| **OS**               | RHEL 9.x (Minimal Install)      |
| **SELinux**          | Enforcing                       |
| **Firewall**         | firewalld                       |
| **Vault Edition**    | Open Source (binary install)    |
| **Storage Backend**  | File storage: `/opt/vault/data` |
| **TLS Directory**    | `/opt/vault/tls/`               |
| **Config Directory** | `/etc/vault.d/`                 |
| **Binary**           | `/usr/local/bin/vault`          |


3.2 Resource Allocation (POC)

| Resource    | Allocation |
| ----------- | ---------- |
| **vCPU**    | 2          |
| **Memory**  | 4 GB       |
| **Disk**    | **50 GB**  |
| **Network** | 1 Gbps     |
