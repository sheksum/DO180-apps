


cat > /tmp/pln-kdc.ldif << 'EOF'
dn: cn=pln-petipareplica.ipa.calix.local,cn=masters,cn=ipa,cn=etc,dc=ipa,dc=calix,dc=local
objectClass: nsContainer
objectClass: ipaConfigObject
objectClass: top
cn: pln-petipareplica.ipa.calix.local

dn: cn=KDC,cn=pln-petipareplica.ipa.calix.local,cn=masters,cn=ipa,cn=etc,dc=ipa,dc=calix,dc=local
objectClass: nsContainer
objectClass: ipaConfigObject
objectClass: top
ipaConfigString: startOrder 10
ipaConfigString: configuredService
ipaConfigString: kdcProxyEnabled
ipaConfigString: pkinitEnabled
ipaConfigString: enabledService
cn: KDC
EOF

ldapadd -x -H ldap://localhost -D "cn=directory manager" -W -f /tmp/pln-kdc.ldif




# Check if the KDC entry exists on the master now
ldapsearch -x -H ldap://localhost -D "cn=directory manager" -W -b "cn=KDC,cn=pln-petipareplica.ipa.calix.local,cn=masters,cn=ipa,cn=etc,dc=ipa,dc=calix,dc=local" "(objectclass=*)"


ldapsearch -x -H ldap://localhost -D "cn=directory manager" -W -b "cn=KDC,cn=cpeg-ipareplica.ipa.calix.local,cn=masters,cn=ipa,cn=etc,dc=ipa,dc=calix,dc=local" "(objectclass=*)"


ldapsearch -x -H ldap://localhost -D "cn=directory manager" -W -b "cn=config" "(objectclass=nsds5replicationagreement)" nsds5replicahost nsds5replicaLastUpdateStatus



ldapsearch -x -H ldap://cpeg-ipareplica.ipa.calix.local -D "cn=directory manager" -W -b "cn=config" "(objectclass=nsds5replicationagreement)" nsds5replicahost nsds5replicaLastUpdateStatus
