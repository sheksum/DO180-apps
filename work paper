

oc apply -f - <<EOF
apiVersion: metallb.io/v1beta1
kind: MetalLB
metadata:
  name: metallb
  namespace: metallb-system
spec:
  logLevel: warn
EOF

oc apply -f - <<EOF
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: ai-services-dev
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.160-10.172.248.163
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: ai-services-test
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.165-10.172.248.168
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: ai-services-prod
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.170-10.172.248.173
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: reserved-future
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.175-10.172.248.180
  autoAssign: false
EOF



ipaddresspool.metallb.io/ai-services-dev created
ipaddresspool.metallb.io/ai-services-test created
ipaddresspool.metallb.io/ai-services-prod created
ipaddresspool.metallb.io/reserved-future created



oc apply -f - <<EOF
apiVersion: metallb.io/v1beta1
kind: L2Advertisement
metadata:
  name: l2-vlan1510
  namespace: metallb-system
spec:
  ipAddressPools:
    - ai-services-dev
    - ai-services-test
    - ai-services-prod
EOF




oc apply -f - <<EOF
apiVersion: v1
kind: Namespace
metadata:
  name: pai-dev
  labels:
    env: dev
    app.kubernetes.io/part-of: pai
---
apiVersion: v1
kind: Namespace
metadata:
  name: pai-test
  labels:
    env: test
    app.kubernetes.io/part-of: pai
---
apiVersion: v1
kind: Namespace
metadata:
  name: pai-prod
  labels:
    env: prod
    app.kubernetes.io/part-of: pai
EOF



oc apply -f - <<EOF
apiVersion: v1
kind: Service
metadata:
  name: nginx-test-lb
  namespace: pai-dev
  annotations:
    metallb.universe.tf/address-pool: ai-services-dev
    metallb.universe.tf/loadBalancerIPs: "10.172.248.160"
spec:
  type: LoadBalancer
  loadBalancerIP: "10.172.248.160"
  ports:
    - port: 80
      targetPort: 8080
  selector:
    app: nginx-test
EOF



NAME            TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE
nginx-test-lb   LoadBalancer   172.30.37.234   <pending>     80:30808/TCP   45s
hsuma@plnx-admin:~$
hsuma@plnx-admin:~$
hsuma@plnx-admin:~$ oc describe svc nginx-test-lb -n pai-dev | tail -20
Annotations:              metallb.universe.tf/address-pool: ai-services-dev
                          metallb.universe.tf/loadBalancerIPs: 10.172.248.160
Selector:                 app=nginx-test
Type:                     LoadBalancer
IP Family Policy:         SingleStack
IP Families:              IPv4
IP:                       172.30.37.234
IPs:                      172.30.37.234
Desired LoadBalancer IP:  10.172.248.160
Port:                     <unset>  80/TCP
TargetPort:               8080/TCP
NodePort:                 <unset>  30808/TCP
Endpoints:                10.129.0.154:8080
Session Affinity:         None
External Traffic Policy:  Cluster
Internal Traffic Policy:  Cluster
Events:
  Type     Reason            Age   From                Message
  ----     ------            ----  ----                -------
  Warning  AllocationFailed  72s   metallb-controller  Failed to allocate IP for "pai-dev/nginx-test-lb": service can not have both metallb.io/loadBalancerIPs and svc.Spec.LoadBalancerIP
hsuma@plnx-admin:~$



oc delete svc nginx-test-lb -n pai-dev

oc apply -f - <<EOF
apiVersion: v1
kind: Service
metadata:
  name: nginx-test-lb
  namespace: pai-dev
  annotations:
    metallb.universe.tf/address-pool: ai-services-dev
    metallb.universe.tf/loadBalancerIPs: "10.172.248.160"
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
  selector:
    app: nginx-test
EOF


# Check which speaker owns the VIP
oc logs -l component=speaker -n metallb-system --tail=10

# Check if the endpoint is healthy
oc get endpoints nginx-test-lb -n pai-dev

# Try from a node directly
oc debug node/ocp-ai-master01.calix.local -- curl -s -o /dev/null -w "%{http_code}" http://10.172.248.160
=======


apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: pai-services-dev
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.160-10.172.248.163
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: pai-services-test
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.165-10.172.248.168
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: pai-services-prod
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.170-10.172.248.173
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: reserved-future
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.175-10.172.248.180
  autoAssign: false






apiVersion: metallb.io/v1beta1
kind: L2Advertisement
metadata:
  name: l2-vlan1510
  namespace: metallb-system
spec:
  ipAddressPools:
    - pai-services-dev
    - pai-services-test
    - pai-services-prod


apiVersion: v1
kind: Namespace
metadata:
  name: pai-dev
  labels:
    env: dev
    app.kubernetes.io/part-of: pai
---
apiVersion: v1
kind: Namespace
metadata:
  name: pai-test
  labels:
    env: test
    app.kubernetes.io/part-of: pai
---
apiVersion: v1
kind: Namespace
metadata:
  name: pai-prod
  labels:
    env: prod
    app.kubernetes.io/part-of: pai



apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: metallb
  namespace: openshift-gitops
  labels:
    app.kubernetes.io/part-of: ocp-ai-platform
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
    targetRevision: main
    path: ocp-ai-config/metallb
  destination:
    server: https://kubernetes.default.svc
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - ServerSideApply=true
    retry:
      limit: 5
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m
```

Create those files, then:
```
cd ~/ocp-ai-platform
git add ocp-ai-config/metallb/
git commit -m "Task 6: MetalLB instance, IP pools, L2 advertisement, PAI namespaces"
git push origin main
```

Then apply the ArgoCD app:
```
oc apply -f ocp-ai-config/metallb/argocd-app-metallb.yaml

oc delete ipaddresspool ai-services-dev ai-services-test ai-services-prod reserved-future -n metallb-system

oc apply -f - <<EOF
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: pai-services-dev
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.160-10.172.248.163
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: pai-services-test
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.165-10.172.248.168
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: pai-services-prod
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.170-10.172.248.173
  autoAssign: false
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: reserved-future
  namespace: metallb-system
spec:
  addresses:
    - 10.172.248.175-10.172.248.180
  autoAssign: false
EOF


oc delete l2advertisement l2-vlan1510 -n metallb-system

oc apply -f - <<EOF
apiVersion: metallb.io/v1beta1
kind: L2Advertisement
metadata:
  name: l2-vlan1510
  namespace: metallb-system
spec:
  ipAddressPools:
    - pai-services-dev
    - pai-services-test
    - pai-services-prod
EOF


hsuma@plnx-admin:~/ocp-ai-config$
oc apply -f metallb/argocd-app-metallb.yaml
Warning: metadata.finalizers: "resources-finalizer.argocd.argoproj.io": prefer a domain-qualified finalizer name including a path (/) to avoid accidental conflicts with other finalizer writers
application.argoproj.io/metallb created
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$


hsuma@plnx-admin:~/ocp-ai-config$ oc describe application metallb -n openshift-gitops | tail -30
hsuma@plnx-admin:~/ocp-ai-config$ oc describe application metallb -n openshift-gitops | tail -30
        Duration:      5s
        Factor:        2
        Max Duration:  3m
      Limit:           5
    Sync Options:
      ServerSideApply=true
Status:
  Conditions:
    Last Transition Time:  2026-02-26T03:38:19Z
    Message:               Failed to load target state: failed to generate manifest for source 1 of 1: rpc error: code = Unknown desc = ocp-ai-config/metallb: app path does not exist
    Type:                  ComparisonError
  Controller Namespace:    openshift-gitops
  Health:
    Last Transition Time:  2026-02-26T03:38:20Z
    Status:                Healthy
  Reconciled At:           2026-02-26T03:38:19Z
  Sync:
    Compared To:
      Destination:
        Server:  https://kubernetes.default.svc
      Source:
        Path:             ocp-ai-config/metallb
        Repo URL:         git@bitbucket.org:calixprod/ocp-ai-platform.git
        Target Revision:  main
    Status:               Unknown
Events:
  Type    Reason           Age    From                           Message
  ----    ------           ----   ----                           -------
  Normal  ResourceUpdated  2m12s  argocd-application-controller  Updated sync status:  -> Unknown
  Normal  ResourceUpdated  2m12s  argocd-application-controller  Updated health status:  -> Healthy




hsuma@plnx-admin:~/ocp-ai-config$ oc describe application metallb -n openshift-gitops | tail -30
        Duration:      5s
        Factor:        2
        Max Duration:  3m
      Limit:           5
    Sync Options:
      ServerSideApply=true
Status:
  Conditions:
    Last Transition Time:  2026-02-26T03:38:19Z
    Message:               Failed to load target state: failed to generate manifest for source 1 of 1: rpc error: code = Unknown desc = ocp-ai-config/metallb: app path does not exist
    Type:                  ComparisonError
  Controller Namespace:    openshift-gitops
  Health:
    Last Transition Time:  2026-02-26T03:38:20Z
    Status:                Healthy
  Reconciled At:           2026-02-26T03:46:26Z
  Sync:
    Compared To:
      Destination:
        Server:  https://kubernetes.default.svc
      Source:
        Path:             ocp-ai-config/metallb
        Repo URL:         git@bitbucket.org:calixprod/ocp-ai-platform.git
        Target Revision:  main
    Status:               Unknown
Events:
  Type    Reason           Age    From                           Message
  ----    ------           ----   ----                           -------
  Normal  ResourceUpdated  8m56s  argocd-application-controller  Updated sync status:  -> Unknown
  Normal  ResourceUpdated  8m56s  argocd-application-controller  Updated health status:  -> Healthy
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$ git ls-files m
hsuma@plnx-admin:~/ocp-ai-config$ git ls-files metallb/
metallb/argocd-app.metallb.yaml
metallb/ipaddresspools.yaml
metallb/l2advertisement.yaml
metallb/metallb-instance.yaml
metallb/namespaces.yaml
hsuma@plnx-admin:~/ocp-ai-config$

hsuma@plnx-admin:~/ocp-ai-config$ git remote -v
origin	git@bitbucket.org:calixprod/ocp-ai-platform.git (fetch)
origin	git@bitbucket.org:calixprod/ocp-ai-platform.git (push)
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$ pwd
/home/hsuma/ocp-ai-config
hsuma@plnx-admin:~/ocp-ai-config$ ls -la
total 48
drwxr-xr-x  8 hsuma sw  4096 Feb 25 21:23 .
drwxr-xr-x 46 hsuma sw 16384 Feb 25 21:45 ..
drwxr-xr-x  2 hsuma sw  4096 Feb 23 13:41 apps
drwxr-xr-x  8 hsuma sw  4096 Feb 25 21:44 .git
-rw-r--r--  1 hsuma sw    22 Feb 19 13:55 .gitignore
drwxr-xr-x  2 hsuma sw  4096 Feb 18 14:24 machineconfigs
drwxr-xr-x  2 hsuma sw  4096 Feb 25 21:43 metallb
drwxr-xr-x  2 hsuma sw  4096 Feb 23 22:28 nmstate
-rw-r--r--  1 hsuma sw  2622 Feb 19 13:55 README.md
drwxr-xr-x  2 hsuma sw  4096 Feb 23 19:15 trident
hsuma@plnx-admin:~/ocp-ai-config$



hsuma@plnx-admin:~/ocp-ai-config$ oc get application -A
NAMESPACE          NAME              SYNC STATUS   HEALTH STATUS
openshift-gitops   machineconfigs    Synced        Healthy
openshift-gitops   metallb           Unknown       Healthy
openshift-gitops   nmstate           Synced        Healthy
openshift-gitops   ocp-ai-platform   Synced        Healthy
openshift-gitops   trident           Synced        Healthy
hsuma@plnx-admin:~/ocp-ai-config$ oc describe application metallb -n openshift-gitops | tail -30
    Status:            Unknown
    Version:           v1
    Group:             project.openshift.io
    Kind:              Project
    Name:              pai-test
    Status:            Unknown
    Version:           v1
  Source Hydrator:
  Summary:
    Images:
      registry.redhat.io/openshift4/metallb-rhel9@sha256:668b065e49be9ff1b0ca2e13e504afe5ff4483aec6bf54c9413d9b435b97d6a8
      registry.redhat.io/openshift4/ose-kube-rbac-proxy-rhel9@sha256:5f4b6b4ddff81c2b6e1bb43e0924197ef184132ccb105ef816065bfebe25d002
  Sync:
    Compared To:
      Destination:
        Server:  https://kubernetes.default.svc
      Source:
        Path:             ocp-ai-config/metallb
        Repo URL:         git@bitbucket.org:calixprod/ocp-ai-platform.git
        Target Revision:  main
    Status:               Unknown
Events:
  Type    Reason              Age    From                           Message
  ----    ------              ----   ----                           -------
  Normal  ResourceUpdated     16m    argocd-application-controller  Updated sync status:  -> Unknown
  Normal  ResourceUpdated     16m    argocd-application-controller  Updated health status:  -> Healthy
  Normal  OperationStarted    2m51s  argocd-application-controller  Initiated automated sync to 'b01d9d89a138f16b727c2072bfb42b200da17e3f'
  Normal  ResourceUpdated     2m51s  argocd-application-controller  Updated sync status: Unknown -> OutOfSync
  Normal  OperationCompleted  2m49s  argocd-application-controller  Sync operation to b01d9d89a138f16b727c2072bfb42b200da17e3f succeeded
  Normal  ResourceUpdated     2m48s  argocd-application-controller  Updated sync status: OutOfSync -> Unknown
hsuma@plnx-admin:~/ocp-ai-config$


oc delete application metallb -n openshift-gitops

oc apply -f - <<EOF
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: metallb
  namespace: openshift-gitops
  labels:
    app.kubernetes.io/part-of: ocp-ai-platform
spec:
  project: default
  source:
    repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
    targetRevision: main
    path: metallb
  destination:
    server: https://kubernetes.default.svc
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - ServerSideApply=true
    retry:
      limit: 5
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m
EOF


hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$ cat apps/root-app.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: ocp-ai-platform
  namespace: openshift-gitops
spec:
  project: default
  source:
    repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
    targetRevision: main
    path: apps
  destination:
    server: https://kubernetes.default.svc
  syncPolicy:
    automated:
      selfHeal: true
      prune: false
hsuma@plnx-admin:~/ocp-ai-config$


oc patch application metallb -n openshift-gitops --type merge -p '{"metadata":{"finalizers":null}}'


Application conditions
ComparisonError
Failed to load target state: failed to generate manifest for source 1 of 1: rpc error: code = Unknown desc = ocp-ai-config/metallb: app path does not exist


hsuma@plnx-admin:~/ocp-ai-config$ oc get application metallb -n openshift-gitops -o jsonpath='{.spec.source.path}'
ocp-ai-config/metallbhsuma@plnx-admin:~/ocp-ai-config$


hsuma@plnx-admin:~/ocp-ai-config$


hsuma@plnx-admin:~/ocp-ai-config$ cat apps/test.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  annotations:
  name: gitops-nmstate-access
rules:
- apiGroups:
  - nmstate.io
  resources:
  - nodenetworkconfiguration
  verbs:
  - get
  - list
  - watch
hsuma@plnx-admin:~/ocp-ai-config$


project: default
source:
  repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
  path: trident
  targetRevision: main
destination:
  server: https://kubernetes.default.svc
  namespace: trident
syncPolicy:
  automated:
    prune: true
    selfHeal: true
  syncOptions:
    - CreateNamepace=false

oc apply -f - <<EOF
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: metallb
  namespace: openshift-gitops
spec:
  project: default
  source:
    repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
    targetRevision: main
    path: metallb
  destination:
    server: https://kubernetes.default.svc
    namespace: metallb-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=false
EOF


oc delete application metallb -n openshift-gitops 2>/dev/null; sleep 5

oc apply -f - <<EOF
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: metallb
  namespace: openshift-gitops
spec:
  project: default
  source:
    repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
    targetRevision: main
    path: metallb
  destination:
    server: https://kubernetes.default.svc
    namespace: metallb-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=false
EOF


oc rollout restart deployment openshift-gitops-server -n openshift-gitops
oc rollout restart statefulset openshift-gitops-application-controller -n openshift-gitops



hsuma@plnx-admin:~/ocp-ai-config/apps$ oc get application trident -n openshift-gitops -o jsonpath='{.spec.source.path}'
tridenthsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc get application ocp-ai-platform -n openshift-gitops -o jsonpath='{.spec.source.path}'
appshsuma@plnx-admin:~/ocp-ai-config/apps$


hsuma@plnx-admin:~/ocp-ai-config/apps$ git ls-tree --name-only HEAD
machineconfigs-app.yaml
nmstate-app.yaml
root-app.yaml
trident-apps.yaml
hsuma@plnx-admin:~/ocp-ai-config/apps$




cat > ~/ocp-ai-config/apps/metallb-app.yaml <<EOF
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: metallb
  namespace: openshift-gitops
spec:
  project: default
  source:
    repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
    targetRevision: main
    path: metallb
  destination:
    server: https://kubernetes.default.svc
    namespace: metallb-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=false
EOF





cat > ~/ocp-ai-config/apps/metallb-app.yaml <<EOF
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: metallb
  namespace: openshift-gitops
spec:
  project: default
  source:
    repoURL: git@bitbucket.org:calixprod/ocp-ai-platform.git
    targetRevision: main
    path: metallb
  destination:
    server: https://kubernetes.default.svc
    namespace: metallb-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=false
EOF



hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc get application -n openshift-gitops -w
NAME              SYNC STATUS   HEALTH STATUS
machineconfigs    Synced        Healthy
metallb           Synced        Healthy
nmstate           Synced        Healthy
ocp-ai-platform   Synced        Healthy
trident           Synced        Healthy
^Chsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc get metallb -n metallb-system
NAME      AGE
metallb   83s
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc get ipaddresspools -n metallb-system
NAME                AUTO ASSIGN   AVOID BUGGY IPS   ADDRESSES
pai-services-dev    false         false             ["10.172.248.160-10.172.248.163"]
pai-services-prod   false         false             ["10.172.248.170-10.172.248.173"]
pai-services-test   false         false             ["10.172.248.165-10.172.248.168"]
reserved-future     false         false             ["10.172.248.175-10.172.248.180"]
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc get l2advertisements -n metallb-system
NAME          IPADDRESSPOOLS                                                 IPADDRESSPOOL SELECTORS   INTERFACES
l2-vlan1510   ["pai-services-dev","pai-services-test","pai-services-prod"]
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc get pods -n metallb-system
NAME                                                   READY   STATUS    RESTARTS   AGE
controller-fb7fcb695-hhhnq                             2/2     Running   0          2m9s
metallb-operator-controller-manager-68b4948857-hn29n   1/1     Running   0          123m
metallb-operator-webhook-server-6c48f9b746-ln7vr       1/1     Running   0          123m
speaker-h9xxx                                          2/2     Running   0          2m9s
speaker-k5k8b                                          2/2     Running   0          2m9s
speaker-nn6pq                                          2/2     Running   0          2m9s
hsuma@plnx-admin:~/ocp-ai-config/apps$


hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc explain metallb.spec --api-version=metallb.io/v1beta1
GROUP:      metallb.io
KIND:       MetalLB
VERSION:    v1beta1

FIELD: spec <Object>


DESCRIPTION:
    MetalLBSpec defines the desired state of MetalLB

FIELDS:
  bgpBackend	<string>
    The type of BGP implementation deployed with MetalLB

  controllerConfig	<Object>
    additional configs to be applied on MetalLB Controller deployment.

  controllerNodeSelector	<map[string]string>
    node selector applied to MetalLB controller deployment.

  controllerTolerations	<[]Object>
    tolerations is a list of tolerations applied to MetalLB controller
    deployment.

  frrk8sConfig	<Object>
    The specific frr-k8s configuration

  image	<string>
    Foo is an example field of MetalLB. Edit MetalLB_types.go to remove/update

  loadBalancerClass	<string>
    The loadBalancerClass spec attribute that the MetalLB controller should
    be watching for. must be a label-style identifier, with an optional
    prefix such as "internal-vip" or "example.com/internal-vip". Unprefixed
    names are reserved for end-users.

  logLevel	<string>
  enum: all, debug, info, warn, ....
    Define the verbosity of the controller and the speaker logging.
    Allowed values are: all, debug, info, warn, error, none. (default: info)

  nodeSelector	<map[string]string>
    node selector applied to MetalLB speaker daemonset.

  speakerConfig	<Object>
    additional configs to be applied on MetalLB Speaker daemonset.

  speakerTolerations	<[]Object>
    tolerations is a list of tolerations applied to MetalLB speaker
    daemonset.


hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$ oc explain metallb.spec.controllerConfig --api-version=metallb.io/v1beta1
GROUP:      metallb.io
KIND:       MetalLB
VERSION:    v1beta1

FIELD: controllerConfig <Object>


DESCRIPTION:
    additional configs to be applied on MetalLB Controller deployment.

FIELDS:
  affinity	<Object>
    If specified, the pod's scheduling constraints

  annotations	<map[string]string>
    Annotations to be applied for MetalLB Operator

  priorityClassName	<string>
    Define priority class name

  resources	<Object>
    Resource Requirements to be applied for containers which gets deployed
    via MetalLB Operator

  runtimeClassName	<string>
    Define container runtime configuration class


hsuma@plnx-admin:~/ocp-ai-config/apps$



oc apply -f - <<EOF
apiVersion: gateway.networking.k8s.io/v1
kind: GatewayClass
metadata:
  name: openshift-default
spec:
  controllerName: openshift.io/gateway-controller/v1
EOF



^Chsuma@plnx-admin:~/ocp-ai-config/apps$ oc get pods -n openshift-ingress
NAME                                        READY   STATUS    RESTARTS   AGE
istiod-openshift-gateway-7cd77c7ffd-7wxpq   1/1     Running   0          16s
router-default-56fb65447b-87hkv             1/1     Running   0          2d3h
router-default-56fb65447b-g8jhd             1/1     Running   0          2d3h
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
hsuma@plnx-admin:~/ocp-ai-config/apps$
