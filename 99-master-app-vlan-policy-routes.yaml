DEV_PASS=$(openssl rand -base64 24)
TEST_PASS=$(openssl rand -base64 24)
PROD_PASS=$(openssl rand -base64 24)

echo "Dev:  $DEV_PASS"
echo "Test: $TEST_PASS"
echo "Prod: $PROD_PASS"

vault kv put kv/pai/dev/minio-credentials MINIO_ROOT_USER=minioadmin MINIO_ROOT_PASSWORD="$DEV_PASS"
vault kv put kv/pai/test/minio-credentials MINIO_ROOT_USER=minioadmin MINIO_ROOT_PASSWORD="$TEST_PASS"
vault kv put kv/pai/prod/minio-credentials MINIO_ROOT_USER=minioadmin MINIO_ROOT_PASSWORD="$PROD_PASS"


# Copy 01-external-secrets.yaml and 02-minio-all-envs.yaml to plnx-admin first
# Then:
oc apply -f 01-external-secrets.yaml

# Wait for sync, verify
oc get externalsecrets -A | grep minio
# All three should show SecretSynced / True


oc apply -f 02-minio-all-envs.yaml


# Pods running
oc get pods -n pai-dev -l app=minio
oc get pods -n pai-test -l app=minio
oc get pods -n pai-prod -l app=minio

# LB IPs assigned
oc get svc -A --field-selector spec.type=LoadBalancer

# HTTPRoutes
oc get httproutes -A | grep minio

# Health check
curl -sk https://minio.dev.ocp-ai.calix.local



# On plnx-admin:
oc get secretstore vault-store -n pai-dev -o yaml | grep -A15 "provider:"



# On plnx-admin
oc get packagemanifests -n openshift-marketplace | grep -i minio


hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$ oc get packagemanifests -n openshift-marketplace | grep -i minio
minio-minkms-operator                                Certified Operators   13d
minio-object-store-operator                          Certified Operators   13d
hsuma@plnx-admin:~/ocp-ai-config$


oc describe packagemanifest minio-object-store-operator -n openshift-marketplace | grep -A5 "Default Channel\|Current CSV\|Channels"


hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$ oc describe packagemanifest minio-object-store-operator -n openshift-marketplace | grep -A5 "Default Channel\|Current CSV\|Channels"
  Channels:
    Current CSV:  minio-object-store-operator.v2026.2.9031243
    Current CSV Desc:
      Annotations:
        Alm - Examples:  [
  {
    "apiVersion": "aistor.min.io/v1",
    "kind": "ObjectStore",
--
  Default Channel:  stable
  Package Name:     minio-object-store-operator
  Provider:
    Name:  MinIO
    URL:   https://min.io
Events:    <none>
hsuma@plnx-admin:~/ocp-ai-config$


hsuma@plnx-admin:~/ocp-ai-config$ oc get crd | grep -i minio
hsuma@plnx-admin:~/ocp-ai-config$
hsuma@plnx-admin:~/ocp-ai-config$ oc get crd | grep -i aistor
adminjobs.aistor.min.io                                           2026-03-01T03:45:05Z
objectstores.aistor.min.io                                        2026-03-01T03:45:05Z
hsuma@plnx-admin:~/ocp-ai-config$

oc explain objectstore.spec --api-version=aistor.min.io/v1 | head -60
