📘 Landscape OnPrem Repository – Master Update (with GUI Walkthrough)
Current State
955 systems enrolled in Landscape
OS coverage: Ubuntu 16.04, 18.04, 20.04 (Focal), 22.04 (Jammy), 24.04 (Noble)
Local mirrors: release, security, Chrome
Storage: 1.5 TB logical volume with NFS expansion path


h3. 🔑 Security Architecture
Web UI → HTTPS with internal CA (secure admin access)
Repo traffic → HTTP (efficient, universal)
All packages are GPG-signed, including those re-signed with our on-prem Landscape signing key
Admins = encrypted access, Clients = tamper-proof updates

h3. 🛰 Before vs After (Air-Gapped “Secure Dome”)
Before: Squid proxy to internet repos, fragile and slow
After: Central Landscape repo → all clients trust our key, no internet needed


h3. 🔐 Package Key Management
Repo keys managed inside Landscape GUI
Chrome/3rd party repos added with official GPG keys
All repos mirrored + re-signed with our internal key


GUI Walkthrough for Team
Repositories

A repository is a collection of packages for a specific Ubuntu release.
Landscape mirrors upstream repositories (e.g. Jammy-security).
Each repo is tied to a distribution and one or more pockets.

Pockets
Subsections of a repository.

Examples:
release → base OS packages.
updates → bug fixes.
security → security patches.
backports → newer software versions backported.
In GUI, each pocket can be enabled/disabled per distribution.

Mirrors
Our Landscape mirror syncs upstream repos.
LAN clients fetch from Landscape instead of internet.
This mirror is signed with our on-prem key.

GPG Keys
Guarantee authenticity of packages.
Each repo has a signing key.
In our setup → Landscape re-signs repos with our key.
Clients trust packages because they validate against /etc/apt/trusted.gpg.d/pln-mirror.asc.

Profiles
Define which repos each group of systems should use.
Example: Jammy servers get jammy-release, jammy-security, jammy-updates.
Profiles auto-applied to systems in Landscape.
For systems outside Landscape → script pushes .list file and installs key.

Talking Point:
👉 “When we talk about a repository in Landscape, think of it as the entire set of packages for a release. 
Pockets are the slices inside that repo, like security updates. Our mirror pulls those pockets on-prem and signs them with our key. 
Profiles or scripts then make sure each system gets the right sources.”


h3. 📦 OS Distribution Management
Legacy: 16.04, 18.04
Active: 20.04, 22.04, 24.04
Landscape systems: profiles auto-applied
Non-Landscape systems: script pushes curated mirror list + installs GPG key

h3. 🔄 Update Workflow
Scheduled sync pulls upstream repos → mirrored on-prem
Re-signed with our key
Profiles apply correct pockets for Landscape systems
Script enforces compliance for non-Landscape
Clients update only from trusted on-prem repos

h3. 📅 Tasks Completed (Sept 30, 2025)
Lockdown script, APT lock cleanup, GPG key distribution, validation logging
Dedup of host lists → ~700 non-Landscape systems identified
h3. 📌 Key Benefits
🔒 Security: all updates re-signed with internal key
⚡ Performance: LAN-speed updates
📦 Coverage: Landscape + non-Landscape
📈 Scalability: mirror-based, script-enforced, log-audited
h3. 🔜 Next Steps
Rollout to all 1600 systems
Key refresh automation
Auto-enrollment of new VMs
SOPs for junior admins
Monthly sync + compliance reports
