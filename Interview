#!/bin/bash

echo "[INFO] Checking Calico BGP peering protocols on all nodes..."
pods=$(kubectl get pods -n calico-system -l k8s-app=calico-node -o jsonpath='{.items[*].metadata.name}')

for pod in $pods; do
  echo -e "\n>>> Pod: $pod <<<"
  kubectl exec -it "$pod" -n calico-system -- birdcl show protocols 2>/dev/null || \
    echo "[$pod] Failed to exec or run birdcl"
done
