---
- name: Update DNS entries in /etc/resolv.conf
  hosts: all
  become: true
  tasks:
    - name: Remove 10.16.3.10 from resolv.conf
      lineinfile:
        path: /etc/resolv.conf
        line: "nameserver 10.16.3.10"
        state: absent

    - name: Ensure required DNS nameservers are present (no comments)
      lineinfile:
        path: /etc/resolv.conf
        line: "{{ item }}"
        state: present
        create: no
      loop:
        - "nameserver 10.16.3.8"
        - "nameserver 10.16.3.16"
        - "nameserver 10.16.3.24"
